from alphagenome.models import dna_client
import numpy as np

dna_model = dna_client.create("AIzaSyDaeU_HLHvVAN6tpNK3D82dTVx1olTzxuI")


output = dna_model.predict_sequence(	sequence='TTTCAGGCTGATTGTCAATATGTTTTGTACAATGTTCTCACTTATAGGTGGGAATTGAACAATGAGAACACATGGACACAGGAAGGGGAACATCACACACCGGGGCCTGTTGTGGGGTGGGGGGAAGGGGGAGGGATAGCATTAGGAGATATAACTAGTGTTAAATGACGAGTTAATGGGTGCAGCACACCCACATGGCACATGTATACATATGTAACTAACCTGCACATTGTGCACATGTACCCTAGAACTTAAAGTATAATAAAAAAAAATAGACTCTAGTACTCTGTATTATGCAAAATTTGTCTATGTTACACTTTTTTAACAACACAATCCTATTGCCCTTGAAATCTTCTTCAAAGCATTTCTCGAGTCACTCTTAAAAAGCATCTACAACCTAAAAGTATAGGAAGAGATTTATTTCCTGGAGAAGAGACCCCATTGAGATCTTAAAAGCACATTTAATGTGCCTGTGCTTAACTTAAGGTGCTTAGGACAAAGAAGGCGATTGACATCTTTCAGGTAAAACCTGGTAAGTTTGGTGGTCAAGGAACACAACTGAGACATCACTTGGATGTATTCCTATGACTATTTTAAGAAACATAAATTGTGGTGACTCACTCAGCTCACTTTTAACTACTGCATGGTAATTAAAGATGCAAAATAAAATAAGTTACAAGAAGTGAGGTTTTTTATTGGTTAAAGCAATTTTTCTATATTTTCTCCGCAAGTTGGTCATAAAAGTTCTAAGCATTCCTCTTTTTATAAAATCGAAGCATTATTACTTACTCTCTTGTTAACCTATCTGGATTTTAATTTTGTAACTTTATTATATTTGTTTTGCTGTGATTCTTTAAAAAGCACCTTTAGACTCAGTGAGATAGCAAAAATATCCAAATAGGCCAAAAAATTGTGGCAATGTCCTCTCACTCAGGAAAATTCTGTGTGTTTTCTCTAATGGCCAAGGGAAAACTTGTGAGACTATAAAAGTTAGTCTCAGTACACAAAGCTCAGACTGGCTATTCCCAGATCTCTTCAGGTACATCTAGTCCATTCATAAAGGGCTTTTAATTAACCAAGTGGTTTACTAAAAAGGACAATTCACTACATATTATTCTCTTACAGTTTTTATGCCTCATTCTGTGAAAATTGCTGTAGTCTCTTCCAGTTATGAAGAAGGTAGGTGGAAACAAAGACAAAACACATATATTAGAAGAATGAATGAAATTGTAGCATTTTATTGACAATGAGATGGTTCTATTAGTAGGAATCTATTCTGCATAATTCCATTTTGTGTTTACCTTCTGGAAAAATGAAAGGATTCTGTATGGTTAACTTAAATACTTAGAGAAATTAATATGAATAATGTTAGCAAGAATAACCCTTGTTATAAGTATTATGCTGGCAACAATTGTCGAGTCCTCCTCCTCACTCTTCTGGGCTAATTTGTTCTTTTCTCCCCATTTAATAGTCCTTTTCCCCATCTTTCCCCAGGTCCGGTGTTTTCTTACCCACCTCCTTCCCTCCTTTTTATAATACCAGTGAAACTTGGTTTGGAGCATTTCTTTCACATAAAGGTACAAATCATACTGCTAGAGTTGTGAGGATTTTTACAGCTTTTGAAAGAATAAACTCATTTTAAAAACAGGAAAGCTAAGGCCCAGAGATTTTTAAATGATATTCCCATGATCACACTGTGAATTTGTGCCAGAACCCAAATGCCTACTCCCATCTCACTGAGACTTACTATAAGGACATAAGGCATTTATATATATATATATTATATATACTATATATTTATATATATTACATATTATATATATAATATATATTATATAATATATATTATATTATATAATATATAATATAAATATAATATAAATTATATTATATAATATATAATATAAATATAATATAAATTATATAAATATAATATATATTTTATTATATAATATAATATATATTATATAAATATAATATATAAATTATATAATATAATATATATTATATAATATAATATATTTTATTATATAAATATATATTATATT',
	requested_outputs=[dna_client.OutputType.RNA_SEQ],
    ontology_terms=['UBERON:0002038'],  # Brain_Substantia_Nigra
)

predicted_log_tpm = output.rna_seq
predicted_log_tpm_scalar = float(np.median(predicted_log_tpm.values))
print("Median predicted log(TPM+1):", predicted_log_tpm_scalar) # THIS ISNT LOG TPM THO



